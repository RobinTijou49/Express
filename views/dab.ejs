<% include header %>

<h1><%= title %></h1>

<section>
	<form action="/dab" method="post">
		<div>
			<label for="montant">Montant :</label>
			<input id="montant" name="montant" type="number" step="0.01" min="0" value="<%= typeof montant !== 'undefined' ? montant : '' %>" required />
		</div>

		<div>
			<label for="devise">Devise :</label>
			<select id="devise" name="devise">
				<option value="€" <%= (devise = '€') %>>€</option>
				<option value="$" <%= (devise = '$') %>>$</option>
			</select>
		</div>

		<div>
			<button type="submit">Calculer</button>
		</div>
	</form>
</section>

<section>
	<% if (typeof result !== 'undefined') { %>
		<% if (result.error) { %>
			<p style="color:darkred"><strong>Erreur :</strong> <%= result.error %></p>
		<% } else { %>
			<h2>Résultat pour <%= (result.montant || montant) %> <%= (result.devise || devise) %></h2>
			<% if (Object.keys(result.distribution).length === 0) { %>
				<p>Aucune coupure nécessaire.</p>
			<% } else { %>
				<table>
					<thead>
						<tr><th>Coupure</th><th>Quantité</th></tr>
					</thead>
					<tbody>
						<% for (let denom in result.distribution) { %>
							<tr>
								<td><%= denom %></td>
								<td><%= result.distribution[denom] %></td>
							</tr>
						<% } %>
					</tbody>
				</table>
			<% } %>

			<% if (typeof result.remaining !== 'undefined') { %>
				<p><strong>Reste :</strong> <%= result.remaining %> <%= (result.devise || devise) %></p>
			<% } %>
		<% } %>
	<% } %>
</section>

<% include footer %>
